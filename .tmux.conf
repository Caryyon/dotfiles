# Gmork tmux theme - Inspired by the black wolf from The Neverending Story
# Updated to match Neovim and Alacritty colors
# Author: Claude Code
# Version: 2.0

# Gmork theme colors - Updated to match Neovim and Alacritty
VOID_BLACK="#000000"
SHADOW_BLACK="#111111"
CHARCOAL="#222222"
DARK_GRAY="#2f2f2f"
MEDIUM_GRAY="#404040"
LIGHT_GRAY="#555555"

# Mystical greens (supernatural glow like Gmork's eyes) - enhanced with neon effects
GMORK_GREEN="#00ff00"
EERIE_GREEN="#00ff88"
BRIGHT_GREEN="#88ff00"
TOXIC_GREEN="#00ff44"
NEON_GREEN="#39ff14"
ELECTRIC_GREEN="#00ffff"

# Fiery oranges and reds (blazing supernatural fire) - enhanced with electric effects
FANG_ORANGE="#ff4400"
FIRE_RED="#ff0000"
BLOOD_RED="#ff0044"
EMBER_ORANGE="#ff8800"
ELECTRIC_ORANGE="#ff6600"
PLASMA_RED="#ff3366"

# Earth tones
DARK_BROWN="#3d2f2a"
WOLF_BROWN="#4a3b35"
EARTH_BROWN="#5c4a42"

# Light tones - supernatural brightness
BONE_WHITE="#ffffff"
MIST_GRAY="#dddddd"
PALE_GREEN="#88ff88"

# Set tmux to display in 256 colors
set -g default-terminal    "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

set-option -g focus-events on

# Set border colors - Gmork theme
set-option -g pane-border-style "fg=$DARK_GRAY"
set-option -g pane-active-border-style "fg=$FIRE_RED"

# Set status line message style - Gmork theme
set -g message-style "fg=$BONE_WHITE,bg=$CHARCOAL"
set -g message-command-style "fg=$BONE_WHITE,bg=$CHARCOAL"

# Set mode style (including history bar) - Gmork theme
set -g mode-style "fg=$VOID_BLACK,bg=$BRIGHT_GREEN"

# Enable status bar
set-option -g status on

# Set window list to center
set -g status-justify left

# Gmork theme status bar
set-option -g status-style "bg=$SHADOW_BLACK,fg=$BONE_WHITE"
set-option -g status-left-length 50
set-option -g status-right-length 250

# Status bar left side - Fluid powerline styling
set-option -g status-left "#[bg=$FIRE_RED,fg=$VOID_BLACK,bold] #S #[bg=$SHADOW_BLACK,fg=$BRIGHT_GREEN]#{?client_prefix, âš¡,}#[fg=$FANG_ORANGE]#{?window_zoomed_flag, ðŸ”,} "

# Status bar right side - Fluid powerline styling
set -g status-right "#[fg=$DARK_GRAY]î‚²#[bg=$DARK_GRAY,fg=$LIGHT_GRAY] #(whoami)@#h #[fg=$CHARCOAL,bg=$DARK_GRAY]î‚²#[bg=$CHARCOAL,fg=$BRIGHT_GREEN] #(tmux display-message -p '#{pane_current_path}' | sed 's|.*/||') #[fg=$EERIE_GREEN]âŽ‡#(cd #{pane_current_path}; git branch --show-current 2>/dev/null | head -c 10) #[fg=$FANG_ORANGE]%H:%M #[fg=$EERIE_GREEN]%d %b #[fg=$GMORK_GREEN]âš¡#(uptime | awk '{print $3}' | sed 's/,//')"

# Window status (Gmork theme)
set-window-option -g window-status-style "bg=$SHADOW_BLACK,fg=$MIST_GRAY"
set-window-option -g window-status-current-style "bg=$GMORK_GREEN,fg=$BONE_WHITE,bold"
set-window-option -g window-status-activity-style "bg=$BRIGHT_GREEN,fg=$VOID_BLACK"
set-window-option -g window-status-bell-style "bg=$FANG_ORANGE,fg=$VOID_BLACK"

# Window status format - Fluid powerline styling
set-window-option -g window-status-format "#[bg=$DARK_GRAY,fg=$MIST_GRAY] #I #[bg=$DARK_GRAY,fg=$BONE_WHITE]#W#F #[bg=$SHADOW_BLACK,fg=$DARK_GRAY]î‚°"
set-window-option -g window-status-current-format "#[bg=$BRIGHT_GREEN,fg=$VOID_BLACK,bold] #I #[bg=$BRIGHT_GREEN,fg=$VOID_BLACK]#W#F "

# Start windows numbering at 1
set -g base-index 1

# Start pane numbering at 1
setw -g pane-base-index 1

# Re-draw status window every 5 seconds
set -g status-interval 5

# set scrollback history to 10000 (10k)
set -g history-limit 10000

# enable scroll with mouse
set -g mouse on

# shorten command delay
set -sg escape-time 1

# visual notification of activity in other windows
setw -g monitor-activity on
set -g visual-activity on

# Automatically renumber windows when one is closed
set-option -g renumber-windows on

# Automatically rename windows based on current directory/program
set-window-option -g automatic-rename on
set-option -g automatic-rename-format '#{b:pane_current_path}'
set-option -g allow-rename off

# Vi mode configuration
# Enable vi mode for copy mode
set-window-option -g mode-keys vi

# Copy mode key bindings (vim-style)
# Enter copy mode with prefix + [
# Exit copy mode with q or Escape

# Visual selection and copy bindings
bind-key -T copy-mode-vi 'v' send-keys -X begin-selection
bind-key -T copy-mode-vi 'V' send-keys -X select-line
bind-key -T copy-mode-vi 'C-v' send-keys -X rectangle-toggle
bind-key -T copy-mode-vi 'y' send-keys -X copy-selection-and-cancel

# Vim-style find functionality in copy mode
bind-key -T copy-mode-vi 'f' command-prompt -1 "send -X jump-forward '%%'"
bind-key -T copy-mode-vi 'F' command-prompt -1 "send -X jump-backward '%%'"
bind-key -T copy-mode-vi 't' command-prompt -1 "send -X jump-to-forward '%%'"
bind-key -T copy-mode-vi 'T' command-prompt -1 "send -X jump-to-backward '%%'"
bind-key -T copy-mode-vi ';' send-keys -X jump-again
bind-key -T copy-mode-vi ',' send-keys -X jump-reverse

# Search bindings
bind-key -T copy-mode-vi '/' command-prompt -p "(search down)" "send -X search-forward '%%'"
bind-key -T copy-mode-vi '?' command-prompt -p "(search up)" "send -X search-backward '%%'"
bind-key -T copy-mode-vi 'n' send-keys -X search-again
bind-key -T copy-mode-vi 'N' send-keys -X search-reverse

# Movement keys
bind-key -T copy-mode-vi 'h' send-keys -X cursor-left
bind-key -T copy-mode-vi 'j' send-keys -X cursor-down
bind-key -T copy-mode-vi 'k' send-keys -X cursor-up
bind-key -T copy-mode-vi 'l' send-keys -X cursor-right
bind-key -T copy-mode-vi 'w' send-keys -X next-word
bind-key -T copy-mode-vi 'b' send-keys -X previous-word
bind-key -T copy-mode-vi 'e' send-keys -X next-word-end
bind-key -T copy-mode-vi '0' send-keys -X start-of-line
bind-key -T copy-mode-vi '$' send-keys -X end-of-line
bind-key -T copy-mode-vi '^' send-keys -X back-to-indentation
bind-key -T copy-mode-vi 'g' send-keys -X history-top
bind-key -T copy-mode-vi 'G' send-keys -X history-bottom
bind-key -T copy-mode-vi 'H' send-keys -X top-line
bind-key -T copy-mode-vi 'L' send-keys -X bottom-line
bind-key -T copy-mode-vi 'M' send-keys -X middle-line

# Page navigation
bind-key -T copy-mode-vi 'C-f' send-keys -X page-down
bind-key -T copy-mode-vi 'C-b' send-keys -X page-up
bind-key -T copy-mode-vi 'C-d' send-keys -X halfpage-down
bind-key -T copy-mode-vi 'C-u' send-keys -X halfpage-up

# Exit copy mode
bind-key -T copy-mode-vi 'q' send-keys -X cancel
bind-key -T copy-mode-vi 'Escape' send-keys -X cancel

# Key bindings
# Prefix key setup
set -g prefix C-a
unbind C-b
# use send-prefix to pass C-a through to application
bind C-a send-prefix

# reload ~/.tmux.conf using PREFIX r
bind r source-file ~/.tmux.conf \; display "tmux.conf source"

# Bind <prefix>- to split window horizontally
bind - split-window -v

# Bind <prefix>| to split window vertically
bind | split-window -h

# Map vim movement keys as pane movement keys with prefix
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# resize panes using PREFIX H, J, K, L
bind H resize-pane -L 5
bind J resize-pane -D 5
bind K resize-pane -U 5
bind L resize-pane -R 5

# start new pane in same directory location
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# tmux-resurrect plugin
# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-open'

# tmux-resurrect settings
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-vim 'session'
set -g @resurrect-strategy-nvim 'session'

# Additional resurrect settings for better session restoration
set -g @resurrect-save-shell-history 'off'
set -g @resurrect-processes 'ssh psql mysql sqlite3 "~yarn dev" "~npm start" "~npm run dev"'

# Save and restore vim/nvim sessions with vim-obsession
set -g @resurrect-save-command-strategy 'cmdline'
set -g @resurrect-hook-pre-restore-pane-processes 'tmux switch-client -n && tmux kill-session -t=0'

# tmux-continuum for automatic saves/restores
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Key bindings for resurrect
# prefix + Ctrl-s - save
# prefix + Ctrl-r - restore

# Additional session management bindings
bind S run-shell "~/.tmux/plugins/tmux-resurrect/scripts/save.sh && tmux display-message 'Session saved!'"
bind R run-shell "~/.tmux/plugins/tmux-resurrect/scripts/restore.sh && tmux display-message 'Session restored!'"
bind C command-prompt -p "Create session:" "new-session -s '%%'"
bind X confirm-before -p "Kill session #S? (y/n)" kill-session

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'